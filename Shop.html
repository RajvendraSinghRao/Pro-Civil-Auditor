<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Walk Distance Tracker</title>
<style>
body {
  font-family: 'Segoe UI', sans-serif;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 20px;
  background: #f9f9f9;
}
h1 { color: #2c3e50; text-align: center; }
button {
  background-color: #2c3e50;
  color: #fff;
  border: none;
  padding: 15px 25px;
  margin: 10px;
  border-radius: 5px;
  font-size: 18px;
  cursor: pointer;
}
button:hover { background-color: #34495e; }
#info {
  margin-top: 20px;
  font-size: 20px;
  font-weight: bold;
  text-align: center;
}
</style>
</head>
<body>

<h1>Walk Distance Tracker</h1>
<button id="startBtn">Start Walk</button>
<button id="endBtn" disabled>End Walk</button>

<div id="info">Press "Start Walk" to begin.</div>

<script>
let watchId = null;
let path = []; // array of {lat, lon} points

const startBtn = document.getElementById('startBtn');
const endBtn = document.getElementById('endBtn');
const info = document.getElementById('info');

// Haversine formula to calculate distance between two GPS points in meters
function getDistance(lat1, lon1, lat2, lon2){
  const R = 6371000; // Earth radius in meters
  const rad = Math.PI / 180;
  const dLat = (lat2 - lat1) * rad;
  const dLon = (lon2 - lon1) * rad;
  const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
            Math.cos(lat1*rad) * Math.cos(lat2*rad) *
            Math.sin(dLon/2) * Math.sin(dLon/2);
  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
  return R * c;
}

// Start tracking
startBtn.addEventListener('click', () => {
  if(!navigator.geolocation){
    info.innerText = "Geolocation not supported by your browser.";
    return;
  }

  path = [];
  endBtn.disabled = false;
  startBtn.disabled = true;
  info.innerText = "Walking... GPS tracking active.";

  watchId = navigator.geolocation.watchPosition(pos => {
    path.push({lat: pos.coords.latitude, lon: pos.coords.longitude});
  }, err => {
    info.innerText = "Error getting location: " + err.message;
  }, {enableHighAccuracy:true, maximumAge:1000, timeout:5000});
});

// End tracking and calculate distance
endBtn.addEventListener('click', () => {
  if(watchId !== null){
    navigator.geolocation.clearWatch(watchId);
    watchId = null;
  }

  if(path.length < 2){
    info.innerText = "Not enough data to calculate distance.";
    return;
  }

  // Sum distance between consecutive points
  let totalDist = 0;
  for(let i=1; i<path.length; i++){
    totalDist += getDistance(path[i-1].lat, path[i-1].lon, path[i].lat, path[i].lon);
  }

  const distMeters = totalDist;
  const distFeet = totalDist * 3.28084;
  const distKm = totalDist / 1000;

  info.innerText = `Distance walked:\n${distMeters.toFixed(2)} meters\n${distKm.toFixed(2)} km\n${distFeet.toFixed(2)} ft`;

  startBtn.disabled = false;
  endBtn.disabled = true;
});
</script>

</body>
</html>
