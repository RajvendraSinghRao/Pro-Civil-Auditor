<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Stacked Spirit Level Tool</title>
<style>
  body {
    background: #031526;
    color: white;
    font-family: Arial, sans-serif;
    text-align: center;
    padding: 20px;
    margin: 0;
  }
  h1 {
    color: #0fb1a8;
    margin-bottom: 20px;
  }
  .level-box {
    background: #07293a;
    border: 4px solid #0fb1a8;
    border-radius: 20px;
    padding: 20px;
    width: 280px;
    margin: 20px auto;
    user-select: none;
  }
  .level-box h2 {
    margin-top: 0;
    margin-bottom: 15px;
    font-size: 22px;
    color: #0fb1a8;
  }

  /* Circular Bubble Spirit Level */
  #bubbleLevel {
    position: relative;
    width: 220px;
    height: 220px;
    border-radius: 50%;
    border: 6px solid #0fb1a8;
    background: radial-gradient(circle at center, rgba(0, 255, 255, 0.15), rgba(0, 0, 0, 0.7));
    margin: 0 auto 20px;
    overflow: hidden;
  }
  #bubble {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    border: 2px solid #ccc;
    box-shadow: 0 0 12px rgba(255, 255, 0, 0.8);
    position: absolute;
    top: 90px;
    left: 90px;
    transition: left 0.05s linear, top 0.05s linear, background 0.3s;
    background: radial-gradient(circle at 30% 30%, #ffff99, #ffeb3b);
  }

  /* Simple Dot Level */
  #simpleLevel {
    position: relative;
    width: 200px;
    height: 200px;
    border-radius: 50%;
    background: #07293a;
    border: 4px solid #0fb1a8;
    margin: 0 auto;
  }
  #simpleDot {
    position: absolute;
    width: 20px;
    height: 20px;
    background: red;
    border-radius: 50%;
    top: 90px;
    left: 90px;
    transition: left 0.05s linear, top 0.05s linear, background 0.3s;
  }

  /* Tilt display */
  .tilt-angle {
    font-size: 18px;
    margin-top: 15px;
    color: #9fb3c8;
  }
  p.instructions {
    color: #9fb3c8;
    font-size: 14px;
    margin-top: 10px;
    margin-bottom: 0;
  }
</style>
</head>
<body>

<h1>üìè Stacked Spirit Level Tools</h1>

<div class="level-box" id="bubbleBox">
  <h2>Spirit Bubble Level</h2>
  <div id="bubbleLevel">
    <div id="bubble"></div>
  </div>
  <div class="tilt-angle" id="bubbleTilt">Tilt: 0¬∞</div>
  <p class="instructions">
    Realistic yellow bubble floats inside a liquid tube.<br>
    Turns green and beeps when perfectly level.
  </p>
</div>

<div class="level-box" id="simpleBox">
  <h2>Simple Dot Level</h2>
  <div id="simpleLevel">
    <div id="simpleDot"></div>
  </div>
  <div class="tilt-angle" id="simpleTilt">Tilt: 0¬∞</div>
  <p class="instructions">
    A simple red dot moves inside a circle.<br>
    Turns green and beeps when perfectly level.
  </p>
</div>

<script>
  // Beep function for both tools
  function beep() {
    const ctx = new (window.AudioContext || window.webkitAudioContext)();
    const osc = ctx.createOscillator();
    const gainNode = ctx.createGain();
    osc.connect(gainNode);
    gainNode.connect(ctx.destination);
    osc.type = 'sine';
    osc.frequency.value = 1000;
    gainNode.gain.value = 0.1;
    osc.start();
    osc.stop(ctx.currentTime + 0.1);
  }

  let lastBeepTime = 0;

  if (window.DeviceOrientationEvent) {
    window.addEventListener('deviceorientation', function(event) {
      let beta = event.beta || 0;   // front/back tilt [-180,180]
      let gamma = event.gamma || 0; // left/right tilt [-90,90]

      // Clamp tilt values to [-45,45]
      let x = Math.min(Math.max(gamma, -45), 45);
      let y = Math.min(Math.max(beta, -45), 45);

      // --- Circular Bubble Spirit Level ---
      let bubble = document.getElementById('bubble');
      bubble.style.left = 90 + (x * 2) + "px";
      bubble.style.top = 90 + (y * 2) + "px";

      let tilt = Math.sqrt(x * x + y * y).toFixed(1);
      document.getElementById('bubbleTilt').textContent = `Tilt: ${tilt}¬∞`;

      if (tilt <= 1) {
        bubble.style.background = "radial-gradient(circle at 30% 30%, #aaffaa, #00ff00)";
      } else {
        bubble.style.background = "radial-gradient(circle at 30% 30%, #ffff99, #ffeb3b)";
      }

      // --- Simple Dot Level ---
      let simpleDot = document.getElementById('simpleDot');
      simpleDot.style.left = 90 + (x * 2) + "px";
      simpleDot.style.top = 90 + (y * 2) + "px";

      document.getElementById('simpleTilt').textContent = `Tilt: ${tilt}¬∞`;

      simpleDot.style.background = (tilt <= 1) ? "lime" : "red";

      // Beep once per second if level
      let now = Date.now();
      if (tilt <= 1 && now - lastBeepTime > 1000) {
        beep();
        lastBeepTime = now;
      }
    });
  } else {
    alert("Your device does not support orientation sensors.");
  }
</script>

</body>
</html>
